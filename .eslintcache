[{"E:\\workspace\\sandpack\\tab-editor-test\\src\\App.js":"1","E:\\workspace\\sandpack\\tab-editor-test\\src\\index.js":"2","E:\\workspace\\sandpack\\tab-editor-test\\src\\reportWebVitals.js":"3","E:\\workspace\\sandpack\\tab-editor-test\\src\\App1.js":"4","E:\\workspace\\sandpack\\tab-editor-test\\src\\Terminal.js":"5"},{"size":10447,"mtime":1609131951411,"results":"6","hashOfConfig":"7"},{"size":502,"mtime":1609663598244,"results":"8","hashOfConfig":"7"},{"size":362,"mtime":1606370587204,"results":"9","hashOfConfig":"7"},{"size":13846,"mtime":1609664371239,"results":"10","hashOfConfig":"7"},{"size":1871,"mtime":1609131671463,"results":"11","hashOfConfig":"7"},{"filePath":"12","messages":"13","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"1b007ue",{"filePath":"14","messages":"15","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"16","messages":"17","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"18","messages":"19","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"20"},{"filePath":"21","messages":"22","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"E:\\workspace\\sandpack\\tab-editor-test\\src\\App.js",[],"E:\\workspace\\sandpack\\tab-editor-test\\src\\index.js",[],"E:\\workspace\\sandpack\\tab-editor-test\\src\\reportWebVitals.js",[],"E:\\workspace\\sandpack\\tab-editor-test\\src\\App1.js",["23","24"],"//不依赖本地文件，自定义文件树节点\r\nimport React from 'react'\r\nimport TabsControl from 'tab-code-editor'\r\nimport Ztree from 'file-ztree'\r\n//import Terminal from './Terminal'\r\nimport Terminal from 'react-terminal1'\r\nimport './globalstyles.css'\r\n\r\nconst filetree = [\r\n  {\r\n    filename: \"pNode0 1\",\r\n    isFolder: true,\r\n    extend: true,\r\n    subdirectory: [\r\n      {\r\n        filename: \"pNode1 1\",\r\n        isFolder: true,\r\n        extend: false,\r\n        subdirectory: [\r\n          {\r\n            filename: \"sNode11 1.js\",\r\n            isFolder: false,\r\n          },\r\n          {\r\n            filename: \"sNode11 2.html\",\r\n            isFolder: false,\r\n          },\r\n          {\r\n            filename: \"sNode11 3.css\",\r\n            isFolder: false,\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    filename: \"pNode0 2\",\r\n    isFolder: true,\r\n    extend: false,\r\n    subdirectory: []\r\n  },\r\n  {\r\n    filename: \"sNode0 3.js\",\r\n    isFolder: false,\r\n  }\r\n]\r\nvar inifiles = { //左侧文件树内容\r\n    '/pNode0 1/pNode1 1/sNode11 1.js': {\r\n        code: \"document.body.innerHTML = `<div>sNode 111.js</div>`\",\r\n    },\r\n    '/pNode0 1/pNode1 1/sNode11 2.js': {\r\n        code: \"document.body.innerHTML = `<div>sNode 112.js</div>`\",\r\n    },\r\n    '/pNode0 1/pNode1 1/sNode11 2.html': {\r\n        code: \"document.body.innerHTML = `<div>sNode 112.html</div>`\",\r\n    },\r\n    '/pNode0 1/pNode1 1/sNode11 3.css': {\r\n        code: \"document.body.innerHTML = `<div>sNode 113.css</div>`\",\r\n    },\r\n    '/sNode0 3.js': {\r\n        code: \"document.body.innerHTML = `<div>/sNode0 3.js</div>`\",\r\n    },\r\n    '/sNode0 4.js': {\r\n        code: \"document.body.innerHTML = `<div>/sNode0 3.js</div>`\",\r\n    }\r\n};\r\nexport default class App extends React.PureComponent {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            tabs: [\r\n                // {\r\n                //     id: -1,\r\n                //     name: \"fsds\",\r\n                //     filepath:\"sd\"\r\n                // }\r\n            ],\r\n            count: 0,\r\n            isShowTerminal: false,\r\n        }\r\n    }\r\n    componentDidMount() {\r\n        const _this = this;\r\n        //_this.terminal.layout()\r\n        //console.log(_this.terminal.current)\r\n        window.onresize = function () {\r\n            if (_this.tab_control.monaco.current) {\r\n                _this.tab_control.monaco.current.editor.layout()\r\n            }\r\n            if (_this.terminal) {\r\n                // _this.terminal.fitAddon.fit()\r\n                _this.terminal.layout()\r\n            }\r\n        }\r\n        document.onkeydown = function () {\r\n            var oEvent = window.event;\r\n            if (oEvent.keyCode === 83 && oEvent.ctrlKey) {  //ctrl+s\r\n                let cur_code = _this.tab_control.getValue();\r\n                let path = _this.ztree.getSelectedFiles().filePath;\r\n                inifiles[path].code = cur_code;\r\n                //console.log(\"你按下了ctrl+s\", cur_code);\r\n                oEvent.preventDefault();\r\n            }\r\n            if (oEvent.keyCode === 192 && oEvent.ctrlKey) {\r\n                if (_this.state.isShowTerminal) { //显示\r\n                    _this.setState({ isShowTerminal: false })\r\n                } else { //关闭\r\n                    //var topDiv = document.querySelector('.tabsControl')\r\n                    //topDiv.style.bottom = 0 + 'px'\r\n                    _this.setState({ isShowTerminal: true })\r\n                }\r\n                oEvent.preventDefault();\r\n            }\r\n        }\r\n    }\r\n    horizontalResize(e, minWidth, maxWidth) {\r\n        var leftDiv = document.getElementById('tree')\r\n        var hResizeDiv = document.querySelector('.h-resize')\r\n        var rightDiv = document.querySelector('.right')\r\n        var leftDivWidth = leftDiv.offsetWidth\r\n        const _this = this\r\n        var startX = e.clientX\r\n        document.onmousemove = function (e) {\r\n            e.preventDefault()\r\n            var distX = Math.abs(e.clientX - startX)\r\n            if (e.clientX > startX) {\r\n                leftDiv.style.width = leftDivWidth + distX + 'px'\r\n                hResizeDiv.style.left = leftDivWidth + distX + 'px'\r\n                rightDiv.style.marginLeft = leftDivWidth + distX + 2 + 'px'\r\n            }\r\n            if (e.clientX < startX) {\r\n                leftDiv.style.width = (leftDivWidth - distX) + 'px'\r\n                hResizeDiv.style.left = (leftDivWidth - distX) + 'px'\r\n                rightDiv.style.marginLeft = (leftDivWidth - distX) + 2 + 'px'\r\n            }\r\n            // 最大高度，也可以通过css  max-height设置\r\n            if (parseInt(leftDiv.style.width) >= maxWidth) {\r\n                leftDiv.style.width = maxWidth + 'px'\r\n                hResizeDiv.style.left = maxWidth + 'px'\r\n                rightDiv.style.marginLeft = maxWidth + 2 + 'px'\r\n            }\r\n            if (parseInt(leftDiv.style.width) <= minWidth) {\r\n                leftDiv.style.width = minWidth + 'px'\r\n                hResizeDiv.style.left = minWidth + 'px'\r\n                rightDiv.style.marginLeft = minWidth + 2 + 'px'\r\n            }\r\n            if (_this.tab_control.monaco.current) {\r\n                _this.tab_control.monaco.current.editor.layout()\r\n            }\r\n        }\r\n        document.onmouseup = function () {\r\n            document.onmousemove = null\r\n        }\r\n    }\r\n    verticalResize(e, minHeight, maxHeight) {\r\n        const _this = this;\r\n        //var topDiv = document.querySelector('.tabsControl')\r\n        var bottomDiv = document.getElementById('terminal-container')\r\n        var vResizeDiv = document.querySelector('.v-resize')\r\n        var bottomDivHeight = bottomDiv.offsetHeight\r\n\r\n        var startY = e.clientY\r\n        document.onmousemove = function (e) {\r\n            e.preventDefault()\r\n            var distY = Math.abs(e.clientY - startY)\r\n            if (e.clientY < startY) {\r\n                bottomDiv.style.height = bottomDivHeight + distY + 'px'\r\n                vResizeDiv.style.bottom = bottomDivHeight + distY + 'px'\r\n                //topDiv.style.bottom = bottomDivHeight + distY +2+ 'px'\r\n            }\r\n            if (e.clientY > startY) {\r\n                bottomDiv.style.height = (bottomDivHeight - distY) + 'px'\r\n                vResizeDiv.style.bottom = (bottomDivHeight - distY) + 'px'\r\n                //topDiv.style.bottom = (bottomDivHeight - distY) + 2 + 'px'\r\n            }\r\n            // 最大高度，也可以通过css  max-height设置\r\n            if (parseInt(bottomDiv.style.height) >= maxHeight) {\r\n                bottomDiv.style.height = maxHeight + 'px'\r\n                vResizeDiv.style.bottom = maxHeight + 'px'\r\n            }\r\n            if (parseInt(bottomDiv.style.height) <= minHeight) {\r\n                bottomDiv.style.height = minHeight + 'px'\r\n                vResizeDiv.style.bottom = minHeight + 'px'\r\n            }\r\n            //resize code-deitor and terminal\r\n            if (_this.tab_control.monaco.current) {\r\n                _this.tab_control.monaco.current.editor.layout()\r\n            }\r\n            // console.log(_this.terminal)\r\n            // if (_this.terminal.current) {\r\n                 _this.terminal.layout()\r\n            // }\r\n        }\r\n        document.onmouseup = function () {\r\n            document.onmousemove = null\r\n        }\r\n    }\r\n    closeTerminal() {\r\n        document.getElementById('terminal-container').style.visibility = 'hidden'\r\n        document.querySelector('.v-resize').style.visibility = 'hidden'\r\n    }\r\n    readFile(filepath) {\r\n        return new Promise((resolve, reject) => {\r\n            if (1 < 2) {\r\n                let code = inifiles[filepath].code\r\n                resolve(code)\r\n            } else {\r\n                reject(\"error\")\r\n            }\r\n        })\r\n    }\r\n    tabClick = (tab) => {\r\n        //console.log(\"sd\", this.ztree.getSelectedFiles())\r\n        this.ztree.selectFile(tab.id);\r\n        return new Promise((resolve, reject) => {\r\n            if (1 < 2) {\r\n                resolve()\r\n            } else {\r\n                reject(\"保存失败！\")\r\n            }\r\n        })\r\n    }\r\n    tabClose = (tab, active_tab) => {\r\n        console.log(\"tabClose\", tab)\r\n        if (active_tab) {\r\n            this.ztree.selectFile(active_tab.id);\r\n        }\r\n        return new Promise((resolve, reject) => {\r\n            if (1 < 2) {\r\n                resolve()\r\n            } else {\r\n                reject(\"保存失败！\")\r\n            }\r\n        })\r\n    }\r\n    addFile = (parentFolder, newFile) => {\r\n        console.log(\"APP configure file _source\", newFile)\r\n        console.log(\"APP configure parentNode是：\", parentFolder)\r\n        var file = {\r\n          [newFile.filePath]: {\r\n            code: \"tab.value\"\r\n          }\r\n        };\r\n        Object.assign(inifiles, file)\r\n        var tab = {\r\n            id: newFile.tId,\r\n            name: newFile.filename,\r\n            filepath: newFile.filePath\r\n        };\r\n        this.tab_control.openInTab(tab);\r\n\r\n        return new Promise((resolve, reject) => {\r\n            //let num = Math.round(Math.random() * 10);\r\n            if (1 < 2) {\r\n                resolve();\r\n            } else {\r\n                reject();\r\n            }\r\n        })\r\n    }\r\n    addFolder = (parentFolder, newFolder) => {\r\n        console.log(\"APP configure folder _source\", newFolder)\r\n        console.log(\"APP configure parentNode是：\", parentFolder)\r\n        return new Promise((resolve, reject) => {\r\n            if (1 < 2) {\r\n                resolve();\r\n            } else {\r\n                reject();\r\n            }\r\n        })\r\n    }\r\n    rename = (beforeFile, afterFile) => {\r\n        console.log(\"APP configure rename _source:\", afterFile)\r\n        console.log(\"APP configure rename oldsource\", beforeFile);\r\n\r\n        let oldpath = beforeFile.filePath\r\n        let newpath = afterFile.filePath\r\n\r\n        var tabs = this.state.tabs\r\n        for (let i = 0; i < tabs.length; i++) {\r\n            if (tabs[i].id === afterFile.tId) {\r\n                tabs[i].name = afterFile.filename;\r\n                this.tab_control.tabReset(tabs[i])\r\n                break;\r\n            }\r\n        }\r\n        return new Promise((resolve, reject) => {\r\n            //let num = Math.round(Math.random() * 10);\r\n            if (1 < 2) {\r\n                resolve();\r\n            } else {\r\n                reject();\r\n            }\r\n        })\r\n    }\r\n    remove = (fileNode) => {\r\n        //console.log(\"APP remove _source\", fileNode);\r\n        var tabs = this.state.tabs\r\n        \r\n\r\n        for (let i = 0; i < tabs.length; i++) {\r\n            if (tabs[i].id === fileNode.tId) {\r\n                this.tab_control.tabClose(tabs[i])\r\n                break;\r\n            }\r\n        }\r\n        return new Promise((resolve, reject) => {\r\n            if (1 < 2) {\r\n                resolve();\r\n            } else {\r\n                reject();\r\n            }\r\n        })\r\n    }\r\n    clickFile = (fileNode) => {\r\n        console.log(\"APP clickFile _source\", fileNode);\r\n        if (!fileNode.isFolder) { //点击文件\r\n            var tab = {\r\n                id: fileNode.tId,\r\n                name: fileNode.filename,\r\n                filepath: fileNode.filePath\r\n            }\r\n            var tabs = [...this.state.tabs]\r\n            tabs.push(tab)\r\n            this.setState({ tabs: tabs })\r\n            this.tab_control.openInTab(tab)\r\n        }\r\n        return new Promise((resolve, reject) => {\r\n            if (1 < 2) {\r\n                //console.log(num);\r\n                resolve();\r\n            } else {\r\n                //console.log(num);\r\n                reject();\r\n            }\r\n        })\r\n    }\r\n    render() {\r\n        const tab_configure = {\r\n            title: {\r\n                show_title: true,\r\n                content: 'sss'\r\n            },\r\n            tabClick: this.tabClick,\r\n            tabClose: this.tabClose\r\n        }\r\n\r\n        const configure = {\r\n            error: false,\r\n            errorCallBack: () => {\r\n                console.log(\"error\");\r\n            },\r\n            addFile: this.addFile,\r\n            addFolder: this.addFolder,\r\n            rename: this.rename,\r\n            remove: this.remove,\r\n            clickFile: this.clickFile\r\n        };\r\n\r\n        return (\r\n            <div className=\"App\">\r\n                <Ztree\r\n                    configure={configure}\r\n                    filetree={filetree}\r\n                    onRef={(ref) => { this.ztree = ref; }}\r\n                />\r\n                <div className=\"h-resize\" onMouseDown={event => { this.horizontalResize(event, 250, 700) }}></div>\r\n                <div className=\"right\">\r\n                    <TabsControl\r\n                        tabs={this.state.tabs}\r\n                        readFile={this.readFile}\r\n                        onRef={(ref) => { this.tab_control = ref; }}\r\n                        configure={tab_configure}\r\n                        theme=\"vs-dark\"\r\n                    />\r\n                    <div className=\"v-resize\"\r\n                        onMouseDown={event => { this.verticalResize(event, 200, 800) }}\r\n                        style={this.state.isShowTerminal ? { visibility: \"visible\" } : { visibility: \"hidden\" }}\r\n                    ></div>\r\n                    <div id=\"terminal-container\"\r\n                        style={this.state.isShowTerminal ? { visibility: \"visible\" } : { visibility: \"hidden\" }} >\r\n                        <div className=\"showBtn\">\r\n                            <span onClick={() => {\r\n                                this.closeTerminal()\r\n                            }}> 关闭终端 </span>\r\n                        </div>\r\n                        <Terminal host=\"localhost:8080\" onRef={(ref) => { this.terminal = ref; }} />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\n\r\n","E:\\workspace\\sandpack\\tab-editor-test\\src\\Terminal.js",[],{"ruleId":"25","severity":1,"message":"26","line":276,"column":13,"nodeType":"27","messageId":"28","endLine":276,"endColumn":20},{"ruleId":"25","severity":1,"message":"29","line":277,"column":13,"nodeType":"27","messageId":"28","endLine":277,"endColumn":20},"no-unused-vars","'oldpath' is assigned a value but never used.","Identifier","unusedVar","'newpath' is assigned a value but never used."]